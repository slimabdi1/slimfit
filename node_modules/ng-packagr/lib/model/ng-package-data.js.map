{"version":3,"file":"ng-package-data.js","sourceRoot":"","sources":["../../../src/lib/model/ng-package-data.ts"],"names":[],"mappings":"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","sourcesContent":["import { NgPackageConfig } from '../../ng-package.schema';\nimport { path } from '../util/path';\n\nexport const SCOPE_PREFIX = '@';\nexport const SCOPE_NAME_SEPARATOR = '/';\nexport const DEFAULT_BUILD_FOLDER = '.ng_pkg_build';\n\nexport class NgPackageData {\n  public readonly pathOffsetFromSourceRoot: string;\n  public readonly fullPackageName: string;\n  public readonly packageNameWithoutScope: string;\n  public readonly scope?: string;\n  public readonly flatModuleFileName: string;\n  public readonly entryFile: string;\n  public readonly destinationPath: string;\n  public readonly buildDirectory: string;\n  public readonly libExternals: any;\n  public readonly jsxConfig?: string;\n  public readonly languageLevel: string[];\n\n  constructor(\n    /**\n     * Source path of the root package (equivalent to the `src` field configured in the root ng-package.json).\n     */\n    public readonly rootSourcePath: string,\n    rootPackageName: string,\n    /**\n     * Destination path of the root package (equivalent to the `dest` field configured in the root ng-package.json).\n     */\n    public readonly rootDestinationPath: string,\n    /**\n     * Source path of the current package (equivalent to a sub folder of the `src` field configured in the root ng-package.json).\n     */\n    public readonly sourcePath: string,\n    ngPackageConfig: NgPackageConfig\n  ) {\n    this.pathOffsetFromSourceRoot = this.sourcePath.substring(rootSourcePath.length);\n    // destination path of secondary modules is not configurable - this is to meet the Angular package format.\n    this.destinationPath = rootDestinationPath + this.pathOffsetFromSourceRoot;\n    this.fullPackageName = path.ensureUnixPath(rootPackageName + this.pathOffsetFromSourceRoot);\n\n    if (this.fullPackageName.startsWith(SCOPE_PREFIX)) {\n      const firstSeparatorIndex: number = this.fullPackageName.indexOf(SCOPE_NAME_SEPARATOR);\n      if (firstSeparatorIndex > -1) { // if there is no scope name separator\n        this.scope = this.fullPackageName.substring(0, firstSeparatorIndex);\n        this.packageNameWithoutScope = this.fullPackageName.substring(firstSeparatorIndex + 1);\n      }\n    }\n\n    if (!this.packageNameWithoutScope) { // no scope was detected\n      this.packageNameWithoutScope = this.fullPackageName;\n    }\n\n    if (ngPackageConfig.lib) {\n      this.libExternals = ngPackageConfig.lib.externals;\n      this.flatModuleFileName = ngPackageConfig.lib.flatModuleFile;\n      this.entryFile = ngPackageConfig.lib.entryFile;\n      this.jsxConfig = ngPackageConfig.lib.jsx;\n      this.languageLevel = ngPackageConfig.lib.languageLevel;\n    }\n\n    if (!this.libExternals) {\n      this.libExternals = {};\n    }\n    if (!this.flatModuleFileName) {\n      this.flatModuleFileName = path.basename(this.fullPackageName);\n    }\n    if (!this.entryFile) {\n      this.entryFile = 'public_api.ts';\n    }\n    if (!this.languageLevel) {\n      this.languageLevel = ['dom', 'es2015'];\n    }\n\n    // Each entry point gets it's own unique build directory based upon the package name.\n    const packageBuildFolderName: string = this.fullPackageName.replace(SCOPE_NAME_SEPARATOR, '-');\n    this.buildDirectory = path.resolve(this.rootSourcePath, DEFAULT_BUILD_FOLDER, packageBuildFolderName);\n  }\n}\n\n"]}